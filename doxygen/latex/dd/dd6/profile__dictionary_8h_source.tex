\hypertarget{profile__dictionary_8h_source}{}\doxysection{profile\+\_\+dictionary.\+h}
\label{profile__dictionary_8h_source}\index{tesseract\_command\_language/include/tesseract\_command\_language/profile\_dictionary.h@{tesseract\_command\_language/include/tesseract\_command\_language/profile\_dictionary.h}}
\mbox{\hyperlink{profile__dictionary_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 }
\DoxyCodeLine{26 \textcolor{preprocessor}{\#ifndef TESSERACT\_MOTION\_PLANNERS\_PROFILE\_DICTIONARY\_H}}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#define TESSERACT\_MOTION\_PLANNERS\_PROFILE\_DICTIONARY\_H}}
\DoxyCodeLine{28 }
\DoxyCodeLine{29 \textcolor{preprocessor}{\#include <tesseract\_common/macros.h>}}
\DoxyCodeLine{30 TESSERACT\_COMMON\_IGNORE\_WARNINGS\_PUSH}
\DoxyCodeLine{31 \textcolor{preprocessor}{\#include <any>}}
\DoxyCodeLine{32 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{33 \textcolor{preprocessor}{\#include <typeindex>}}
\DoxyCodeLine{34 \textcolor{preprocessor}{\#include <unordered\_map>}}
\DoxyCodeLine{35 \textcolor{preprocessor}{\#include <memory>}}
\DoxyCodeLine{36 \textcolor{preprocessor}{\#include <shared\_mutex>}}
\DoxyCodeLine{37 TESSERACT\_COMMON\_IGNORE\_WARNINGS\_POP}
\DoxyCodeLine{38 }
\DoxyCodeLine{39 \textcolor{preprocessor}{\#ifdef SWIG}}
\DoxyCodeLine{40 \%shared\_ptr(\mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary}{tesseract\_planning::ProfileDictionary}})}
\DoxyCodeLine{41 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{// SWIG}}
\DoxyCodeLine{42 }
\DoxyCodeLine{43 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacetesseract__planning}{tesseract\_planning}}}
\DoxyCodeLine{44 \{}
\DoxyCodeLine{54 \textcolor{keyword}{class }\mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary}{ProfileDictionary}}}
\DoxyCodeLine{55 \{}
\DoxyCodeLine{56 \textcolor{keyword}{public}:}
\DoxyCodeLine{57   \textcolor{keyword}{using} \mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_a6ca9e4457bcf32d459ca8d89121a963d}{Ptr}} = std::shared\_ptr<ProfileDictionary>;}
\DoxyCodeLine{58   \textcolor{keyword}{using} \mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_ab9e6bb9185d333d45264d7c17c636bb4}{ConstPtr}} = std::shared\_ptr<const ProfileDictionary>;}
\DoxyCodeLine{59 }
\DoxyCodeLine{65   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ProfileType>}
\DoxyCodeLine{66   \textcolor{keywordtype}{bool} \mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_a027d12665c57e25d5bbdf62520d076ff}{hasProfileEntry}}(\textcolor{keyword}{const} std::string\& ns)\textcolor{keyword}{ const}}
\DoxyCodeLine{67 \textcolor{keyword}{  }\{}
\DoxyCodeLine{68     std::shared\_lock lock(\mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_a303b4cae55aa2bfcaea9aba7adc5d983}{mutex\_}});}
\DoxyCodeLine{69     \textcolor{keyword}{auto} it = \mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_aff842a30b67daa75fcafe9c3921db6b9}{profiles\_}}.find(ns);}
\DoxyCodeLine{70     \textcolor{keywordflow}{if} (it == \mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_aff842a30b67daa75fcafe9c3921db6b9}{profiles\_}}.end())}
\DoxyCodeLine{71       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{72 }
\DoxyCodeLine{73     \textcolor{keywordflow}{return} (it-\/>second.find(std::type\_index(\textcolor{keyword}{typeid}(ProfileType))) != it-\/>second.end());}
\DoxyCodeLine{74   \}}
\DoxyCodeLine{75 }
\DoxyCodeLine{77   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ProfileType>}
\DoxyCodeLine{78   \textcolor{keywordtype}{void} \mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_a8d7bcd45c018b45d2d6b1b7cc7366265}{removeProfileEntry}}(\textcolor{keyword}{const} std::string\& ns)}
\DoxyCodeLine{79   \{}
\DoxyCodeLine{80     std::unique\_lock lock(\mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_a303b4cae55aa2bfcaea9aba7adc5d983}{mutex\_}});}
\DoxyCodeLine{81 }
\DoxyCodeLine{82     \textcolor{keyword}{auto} it = \mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_aff842a30b67daa75fcafe9c3921db6b9}{profiles\_}}.find(ns);}
\DoxyCodeLine{83     \textcolor{keywordflow}{if} (it == \mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_aff842a30b67daa75fcafe9c3921db6b9}{profiles\_}}.end())}
\DoxyCodeLine{84       \textcolor{keywordflow}{return};}
\DoxyCodeLine{85 }
\DoxyCodeLine{86     it-\/>second.erase(std::type\_index(\textcolor{keyword}{typeid}(ProfileType)));}
\DoxyCodeLine{87   \}}
\DoxyCodeLine{88 }
\DoxyCodeLine{93   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ProfileType>}
\DoxyCodeLine{94   std::unordered\_map<std::string, std::shared\_ptr<const ProfileType>> \mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_a55a06d6b378a41a29b5fb776cb525f0f}{getProfileEntry}}(\textcolor{keyword}{const} std::string\& ns)\textcolor{keyword}{ const}}
\DoxyCodeLine{95 \textcolor{keyword}{  }\{}
\DoxyCodeLine{96     std::shared\_lock lock(\mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_a303b4cae55aa2bfcaea9aba7adc5d983}{mutex\_}});}
\DoxyCodeLine{97     \textcolor{keyword}{auto} it = \mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_aff842a30b67daa75fcafe9c3921db6b9}{profiles\_}}.find(ns);}
\DoxyCodeLine{98     \textcolor{keywordflow}{if} (it == \mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_aff842a30b67daa75fcafe9c3921db6b9}{profiles\_}}.end())}
\DoxyCodeLine{99       \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Profile namespace does not exist for '"{}} + ns + \textcolor{stringliteral}{"{}'!"{}});}
\DoxyCodeLine{100 }
\DoxyCodeLine{101     \textcolor{keyword}{auto} it2 = it-\/>second.find(std::type\_index(\textcolor{keyword}{typeid}(ProfileType)));}
\DoxyCodeLine{102     \textcolor{keywordflow}{if} (it2 != it-\/>second.end())}
\DoxyCodeLine{103       \textcolor{keywordflow}{return} std::any\_cast<const std::unordered\_map<std::string, std::shared\_ptr<const ProfileType>>\&>(it2-\/>second);}
\DoxyCodeLine{104 }
\DoxyCodeLine{105     \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Profile entry does not exist for type name '"{}} +}
\DoxyCodeLine{106                              std::string(std::type\_index(\textcolor{keyword}{typeid}(ProfileType)).name()) + \textcolor{stringliteral}{"{}' in namespace '"{}} + ns + \textcolor{stringliteral}{"{}'!"{}});}
\DoxyCodeLine{107   \}}
\DoxyCodeLine{108 }
\DoxyCodeLine{116   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ProfileType>}
\DoxyCodeLine{117   \textcolor{keywordtype}{void} \mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_a3d2b329c3e514c1f50400abaa2b38419}{addProfile}}(\textcolor{keyword}{const} std::string\& ns, \textcolor{keyword}{const} std::string\& profile\_name, std::shared\_ptr<const ProfileType> profile)}
\DoxyCodeLine{118   \{}
\DoxyCodeLine{119     \textcolor{keywordflow}{if} (ns.empty())}
\DoxyCodeLine{120       \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Adding profile with an empty namespace!"{}});}
\DoxyCodeLine{121 }
\DoxyCodeLine{122     \textcolor{keywordflow}{if} (profile\_name.empty())}
\DoxyCodeLine{123       \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Adding profile with an empty string as the key!"{}});}
\DoxyCodeLine{124 }
\DoxyCodeLine{125     \textcolor{keywordflow}{if} (profile == \textcolor{keyword}{nullptr})}
\DoxyCodeLine{126       \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Adding profile that is a nullptr"{}});}
\DoxyCodeLine{127 }
\DoxyCodeLine{128     std::unique\_lock lock(\mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_a303b4cae55aa2bfcaea9aba7adc5d983}{mutex\_}});}
\DoxyCodeLine{129     \textcolor{keyword}{auto} it = \mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_aff842a30b67daa75fcafe9c3921db6b9}{profiles\_}}.find(ns);}
\DoxyCodeLine{130     \textcolor{keywordflow}{if} (it == \mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_aff842a30b67daa75fcafe9c3921db6b9}{profiles\_}}.end())}
\DoxyCodeLine{131     \{}
\DoxyCodeLine{132       std::unordered\_map<std::string, std::shared\_ptr<const ProfileType>> new\_entry;}
\DoxyCodeLine{133       new\_entry[profile\_name] = profile;}
\DoxyCodeLine{134       \mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_aff842a30b67daa75fcafe9c3921db6b9}{profiles\_}}[ns][std::type\_index(\textcolor{keyword}{typeid}(ProfileType))] = new\_entry;}
\DoxyCodeLine{135     \}}
\DoxyCodeLine{136     \textcolor{keywordflow}{else}}
\DoxyCodeLine{137     \{}
\DoxyCodeLine{138       \textcolor{keyword}{auto} it2 = it-\/>second.find(std::type\_index(\textcolor{keyword}{typeid}(ProfileType)));}
\DoxyCodeLine{139       \textcolor{keywordflow}{if} (it2 != it-\/>second.end())}
\DoxyCodeLine{140       \{}
\DoxyCodeLine{141         std::any\_cast<std::unordered\_map<std::string, std::shared\_ptr<const ProfileType>>\&>(it2-\/>second)[profile\_name] =}
\DoxyCodeLine{142             profile;}
\DoxyCodeLine{143       \}}
\DoxyCodeLine{144       \textcolor{keywordflow}{else}}
\DoxyCodeLine{145       \{}
\DoxyCodeLine{146         std::unordered\_map<std::string, std::shared\_ptr<const ProfileType>> new\_entry;}
\DoxyCodeLine{147         new\_entry[profile\_name] = profile;}
\DoxyCodeLine{148         it-\/>second[std::type\_index(\textcolor{keyword}{typeid}(ProfileType))] = new\_entry;}
\DoxyCodeLine{149       \}}
\DoxyCodeLine{150     \}}
\DoxyCodeLine{151   \}}
\DoxyCodeLine{152 }
\DoxyCodeLine{158   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ProfileType>}
\DoxyCodeLine{159   \textcolor{keywordtype}{bool} \mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_aa72e7841d99a279c706c6cac7e73b2a2}{hasProfile}}(\textcolor{keyword}{const} std::string\& ns, \textcolor{keyword}{const} std::string\& profile\_name)\textcolor{keyword}{ const}}
\DoxyCodeLine{160 \textcolor{keyword}{  }\{}
\DoxyCodeLine{161     std::shared\_lock lock(\mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_a303b4cae55aa2bfcaea9aba7adc5d983}{mutex\_}});}
\DoxyCodeLine{162     \textcolor{keyword}{auto} it = \mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_aff842a30b67daa75fcafe9c3921db6b9}{profiles\_}}.find(ns);}
\DoxyCodeLine{163     \textcolor{keywordflow}{if} (it == \mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_aff842a30b67daa75fcafe9c3921db6b9}{profiles\_}}.end())}
\DoxyCodeLine{164       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{165 }
\DoxyCodeLine{166     \textcolor{keyword}{auto} it2 = it-\/>second.find(std::type\_index(\textcolor{keyword}{typeid}(ProfileType)));}
\DoxyCodeLine{167     \textcolor{keywordflow}{if} (it2 != it-\/>second.end())}
\DoxyCodeLine{168     \{}
\DoxyCodeLine{169       \textcolor{keyword}{const} \textcolor{keyword}{auto}\& profile\_map =}
\DoxyCodeLine{170           std::any\_cast<const std::unordered\_map<std::string, std::shared\_ptr<const ProfileType>>\&>(it2-\/>second);}
\DoxyCodeLine{171       \textcolor{keyword}{auto} it3 = profile\_map.find(profile\_name);}
\DoxyCodeLine{172       \textcolor{keywordflow}{if} (it3 != profile\_map.end())}
\DoxyCodeLine{173         \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{174     \}}
\DoxyCodeLine{175     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{176   \}}
\DoxyCodeLine{177 }
\DoxyCodeLine{184   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ProfileType>}
\DoxyCodeLine{185   std::shared\_ptr<const ProfileType> \mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_a76d882f0e611b3404718188d5da22a2c}{getProfile}}(\textcolor{keyword}{const} std::string\& ns, \textcolor{keyword}{const} std::string\& profile\_name)\textcolor{keyword}{ const}}
\DoxyCodeLine{186 \textcolor{keyword}{  }\{}
\DoxyCodeLine{187     std::shared\_lock lock(\mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_a303b4cae55aa2bfcaea9aba7adc5d983}{mutex\_}});}
\DoxyCodeLine{188     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& it = \mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_aff842a30b67daa75fcafe9c3921db6b9}{profiles\_}}.at(ns);}
\DoxyCodeLine{189     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& it2 = it.at(std::type\_index(\textcolor{keyword}{typeid}(ProfileType)));}
\DoxyCodeLine{190     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& profile\_map =}
\DoxyCodeLine{191         std::any\_cast<const std::unordered\_map<std::string, std::shared\_ptr<const ProfileType>>\&>(it2);}
\DoxyCodeLine{192     \textcolor{keywordflow}{return} profile\_map.at(profile\_name);}
\DoxyCodeLine{193   \}}
\DoxyCodeLine{194 }
\DoxyCodeLine{199   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ProfileType>}
\DoxyCodeLine{200   \textcolor{keywordtype}{void} \mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_a3fda030b09c7a0e9789606beaf504c1f}{removeProfile}}(\textcolor{keyword}{const} std::string\& ns, \textcolor{keyword}{const} std::string\& profile\_name)}
\DoxyCodeLine{201   \{}
\DoxyCodeLine{202     std::unique\_lock lock(\mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_a303b4cae55aa2bfcaea9aba7adc5d983}{mutex\_}});}
\DoxyCodeLine{203     \textcolor{keyword}{auto} it = \mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_aff842a30b67daa75fcafe9c3921db6b9}{profiles\_}}.find(ns);}
\DoxyCodeLine{204     \textcolor{keywordflow}{if} (it == \mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_aff842a30b67daa75fcafe9c3921db6b9}{profiles\_}}.end())}
\DoxyCodeLine{205       \textcolor{keywordflow}{return};}
\DoxyCodeLine{206 }
\DoxyCodeLine{207     \textcolor{keyword}{auto} it2 = it-\/>second.find(std::type\_index(\textcolor{keyword}{typeid}(ProfileType)));}
\DoxyCodeLine{208     \textcolor{keywordflow}{if} (it2 != it-\/>second.end())}
\DoxyCodeLine{209       std::any\_cast<std::unordered\_map<std::string, std::shared\_ptr<const ProfileType>>\&>(it2-\/>second)}
\DoxyCodeLine{210           .erase(profile\_name);}
\DoxyCodeLine{211   \}}
\DoxyCodeLine{212 }
\DoxyCodeLine{213 \textcolor{keyword}{protected}:}
\DoxyCodeLine{214   std::unordered\_map<std::string, std::unordered\_map<std::type\_index, std::any>> \mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_aff842a30b67daa75fcafe9c3921db6b9}{profiles\_}};}
\DoxyCodeLine{215   \textcolor{keyword}{mutable} std::shared\_mutex \mbox{\hyperlink{classtesseract__planning_1_1ProfileDictionary_a303b4cae55aa2bfcaea9aba7adc5d983}{mutex\_}};}
\DoxyCodeLine{216 \};}
\DoxyCodeLine{217 \}  \textcolor{comment}{// namespace tesseract\_planning}}
\DoxyCodeLine{218 }
\DoxyCodeLine{219 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{// TESSERACT\_MOTION\_PLANNERS\_PROFILE\_DICTIONARY\_H}}

\end{DoxyCode}
