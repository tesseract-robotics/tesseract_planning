<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tesseract Planning: Tesseract Planning</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="custom_dark_theme.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Tesseract Planning
   </div>
   <div id="projectbrief">Motion and Process Planning Packages</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Tesseract Planning </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="anchor" id="md_README"></a> <a href="https://codecov.io/gh/tesseract-robotics/tesseract_planning"><img src="https://codecov.io/gh/tesseract-robotics/tesseract_planning/branch/master/graph/badge.svg" alt="codecov" style="pointer-events: none;" class="inline"/></a></p>
<p ><a href="https://github.com/tesseract-robotics/tesseract_python"><img src="https://img.shields.io/badge/python-2.7+|3.6+-blue.svg" alt="Python" style="pointer-events: none;" class="inline"/></a></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Platform   </th><th class="markdownTableHeadLeft">CI Status    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Linux (Focal)   </td><td class="markdownTableBodyLeft"><a href="https://github.com/tesseract-robotics/tesseract_planning/actions"><img src="https://github.com/tesseract-robotics/tesseract_planning/workflows/Focal-Build/badge.svg" alt="Build Status" style="pointer-events: none;" class="inline"/></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Linux (Bionic)   </td><td class="markdownTableBodyLeft"><a href="https://github.com/tesseract-robotics/tesseract_planning/actions"><img src="https://github.com/tesseract-robotics/tesseract_planning/workflows/Bionic-Build/badge.svg" alt="Build Status" style="pointer-events: none;" class="inline"/></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Linux (Unstable)   </td><td class="markdownTableBodyLeft"><a href="https://github.com/tesseract-robotics/tesseract_planning/actions"><img src="https://github.com/tesseract-robotics/tesseract_planning/workflows/Unstable-Build/badge.svg" alt="Build Status" style="pointer-events: none;" class="inline"/></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Windows   </td><td class="markdownTableBodyLeft"><a href="https://github.com/tesseract-robotics/tesseract_planning/actions"><img src="https://github.com/tesseract-robotics/tesseract_planning/workflows/Windows-Noetic-Build/badge.svg" alt="Build Status" style="pointer-events: none;" class="inline"/></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Lint (Clang-Format)   </td><td class="markdownTableBodyLeft"><a href="https://github.com/tesseract-robotics/tesseract_planning/actions"><img src="https://github.com/tesseract-robotics/tesseract_planning/workflows/Clang-Format/badge.svg" alt="Build Status" style="pointer-events: none;" class="inline"/></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Lint (Clang-Tidy)   </td><td class="markdownTableBodyLeft"><a href="https://github.com/tesseract-robotics/tesseract_planning/actions"><img src="https://github.com/tesseract-robotics/tesseract_planning/workflows/Clang-Tidy/badge.svg" alt="Build Status" style="pointer-events: none;" class="inline"/></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Lint (CodeCov)   </td><td class="markdownTableBodyLeft"><a href="https://github.com/tesseract-robotics/tesseract_planning/actions"><img src="https://github.com/tesseract-robotics/tesseract_planning/workflows/CodeCov/badge.svg" alt="Build Status" style="pointer-events: none;" class="inline"/></a>   </td></tr>
</table>
<p ><a href="http://github.com/tesseract-robotics/tesseract_planning/issues"><img src="https://img.shields.io/github/issues/tesseract-robotics/tesseract_planning.svg" alt="Github Issues" style="pointer-events: none;" class="inline"/></a></p>
<p ><a href="https://opensource.org/licenses/Apache-2.0"><img src="https://img.shields.io/:license-Apache%202.0-yellowgreen.svg" alt="license - apache 2.0" style="pointer-events: none;" class="inline"/></a> <a href="https://opensource.org/licenses/BSD-2-Clause"><img src="https://img.shields.io/:license-BSD%202--Clause-blue.svg" alt="license - bsd 2 clause" style="pointer-events: none;" class="inline"/></a></p>
<p ><a href="http://rosindustrial.org/news/2016/10/7/better-supporting-a-growing-ros-industrial-software-platform"><img src="https://img.shields.io/badge/support%20level-consortium-brightgreen.png" alt="support level: consortium" class="inline"/></a></p>
<p >This include packages related to both motion and process planning for the Tesseract Motion Planning Environment.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Dependencies</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Dependency   </th><th class="markdownTableHeadNone">Version    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">ROS Industrial CMake Boilerplate   </td><td class="markdownTableBodyNone"><a href="https://github.com/ros-industrial/ros_industrial_cmake_boilerplate/tree/0.2.15"><img src="https://img.shields.io/badge/version-0.2.15-brightgreen" alt="version" class="inline"/></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Tesseract   </td><td class="markdownTableBodyNone"><a href="https://github.com/tesseract-robotics/tesseract/tree/0.9.9"><img src="https://img.shields.io/badge/version-0.9.9-brightgreen" alt="version" class="inline"/></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">IFOPT   </td><td class="markdownTableBodyNone"><a href="https://github.com/ethz-adrl/ifopt/tree/2.1.3"><img src="https://img.shields.io/badge/version-2.1.3-brightgreen" alt="version" class="inline"/></a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TrajOpt   </td><td class="markdownTableBodyNone"><a href="https://github.com/tesseract-robotics/trajopt/tree/0.2.5"><img src="https://img.shields.io/badge/version-0.2.5-brightgreen" alt="version" class="inline"/></a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Descartes Light   </td><td class="markdownTableBodyNone"><a href="https://github.com/swri-robotics/descartes_light/tree/0.3.0"><img src="https://img.shields.io/badge/version-0.3.0-brightgreen" alt="version" class="inline"/></a>   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md2"></a>
Tesseract Setup Wizard and Visualization Tools</h1>
<p ><a href="https://snapcraft.io/tesseract-ignition"><img src="https://github.com/snapcore/snap-store-badges/blob/master/EN/%5BEN%5D-snap-store-black-uneditable%401x.png" alt="" class="inline"/></a></p>
<h1><a class="anchor" id="autotoc_md3"></a>
Tesseract Planning Packages</h1>
<ul>
<li><b>tesseract_motion_planners</b> – This package contains a common interface for Planners and includes implementation for OMPL, TrajOpt, TrajOpt IFOPT and Descartes.</li>
<li><b>tesseract_process_managers</b> – This package contains a common interface for Process Planning and includes implementation for a wide variaty of process found industrial automation like painting, griding, welding, pick and place and more.</li>
<li><b>tesseract_time_parameterization</b> – This package contains a time parameterization algorithms and includes iteritive spline.</li>
</ul>
<h1><a class="anchor" id="autotoc_md4"></a>
Related Repositories</h1>
<ul>
<li><a href="https://github.com/tesseract-robotics/tesseract">Tesseract</a></li>
<li><a href="https://github.com/tesseract-robotics/tesseract_python">Tesseract Python</a></li>
<li><a href="https://github.com/tesseract-robotics/tesseract_ros">Tesseract ROS</a></li>
<li><a href="https://github.com/tesseract-robotics/tesseract_docs">Tesseract Documentation</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md5"></a>
Documentation</h1>
<ul>
<li><a href="https://tesseract-docs.readthedocs.io">Wiki</a></li>
<li><a href="https://tesseract-robotics.github.io/tesseract_planning/">Doxygen</a></li>
<li><a href="https://tesseract-robotics.github.io/tesseract_planning/dev/bench">Benchmark</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md6"></a>
Process Planning Server Tuning</h1>
<p >The planning server is built leveraging the library taskflow which enables you to quickly write parallel and heterogeneous tasks programs which aligns well with process motion planning. These types of libraries leverage thread pools to quickly spin up different tasks as needed. One interesting thing found, if a task consumes a lot of memory, then the malloc library can make a performance decision to allow the thread to hold onto the memory it has for subsequent tasks opposed to giving the memory back to your system. This may be fine if this was the only set of tasks being run but typically in our use case there are other computationally intensive processes which could use this memory.</p>
<h2><a class="anchor" id="autotoc_md7"></a>
Ubuntu</h2>
<h2><a class="anchor" id="autotoc_md8"></a>
tcmalloc (Recommend)</h2>
<p >The recommended approach to address memory management is to leverage the <code>tcmalloc</code> library which is part of Google Performance Tools (<code>gperftools</code>). Experimentation has shown <code>tcmalloc</code> to provide more stable memory management when leveraging the planning server.</p>
<p >This capability can be leveraged by linking the exectuable that contains the planning server against <code>tcmalloc</code> using the following commands:</p>
<div class="fragment"><div class="line">find_package(tesseract_common REQUIRED)</div>
<div class="line">find_package(tcmalloc REQUIRED)</div>
<div class="line"> </div>
<div class="line">add_executable(my_executable src/my_executable.cpp)</div>
<div class="line">target_link_libraries(my_executable PUBLIC tcmalloc::tcmalloc)</div>
</div><!-- fragment --><p >This library provides a set of run-time <a href="https://gperftools.github.io/gperftools/tcmalloc.html">tunables</a>, leveraging a set of environment variables.</p>
<p >The one parameter that has been used to configure tcmalloc to give memory back to the OS is <code>TCMALLOC_RELEASE_RATE</code>:</p>
<div class="fragment"><div class="line">TCMALLOC_RELEASE_RATE   default: 1.0    Rate at which we release unused memory to the system, via madvise(MADV_DONTNEED), on systems that support it. Zero means we never release memory back to the system. Increase this flag to return memory faster; decrease it to return memory slower. Reasonable rates are in the range [0,10].</div>
</div><!-- fragment --><p >Note: This is typically set in the roslaunch file for the planning server node leveraging the <code>&lt;env name="TCMALLOC_RELEASE_RATE" value="10"&gt;</code> tag.</p>
<h2><a class="anchor" id="autotoc_md9"></a>
&lt;tt&gt;ptmalloc&lt;/tt&gt; (Ubuntu OS default)</h2>
<p >The great thing is, the default malloc library <code>ptmalloc</code> provides run-time <a href="https://www.gnu.org/software/libc/manual/html_node/Tunables.html">tunables</a> through a set of environment variables.</p>
<p >The one parameter that has been used to configure libc so it always gives back the memory to the system is setting following memory tunnable:</p>
<div class="fragment"><div class="line">Tunable: glibc.malloc.mmap_threshold</div>
<div class="line"> </div>
<div class="line">export GLIBC_TUNABLES=glibc.malloc.mmap_threshold=1000000</div>
<div class="line"> </div>
<div class="line">This tunable supersedes the MALLOC_MMAP_THRESHOLD_ environment variable and is identical in features.</div>
<div class="line"> </div>
<div class="line">When this tunable is set, all chunks larger than this value in bytes are allocated outside the normal heap, using the mmap system call. This way it is guaranteed that the memory for these chunks can be returned to the system on free. Note that requests smaller than this threshold might still be allocated via mmap.</div>
<div class="line"> </div>
<div class="line">If this tunable is not set, the default value is set to ‘131072’ bytes and the threshold is adjusted dynamically to suit the allocation patterns of the program. If the tunable is set, the dynamic adjustment is disabled and the value is set as static.</div>
</div><!-- fragment --><p >Note: This is typically set in the roslaunch file for the planning server node leveraging the <code>&lt;env name="GLIBC_TUNABLES" value="glibc.malloc.mmap_threshold=1000000"&gt;</code> tag.</p>
<h2><a class="anchor" id="autotoc_md10"></a>
Windows</h2>
<p >TBD</p>
<h1><a class="anchor" id="autotoc_md11"></a>
Evolution</h1>
<p ><a href="https://www.youtube.com/watch?v=rxlzlsSBxAY"><img src="gh_pages/_static/tesseract_evolution.png" alt="Tesseract Evolution Video" class="inline"/></a></p>
<p >How to create:</p>
<ul>
<li>Create Video: <code>gource -1280x720 -seconds-per-day 0.2 --auto-skip-seconds 0.2 --disable-bloom -background d0d3d4 --hide filenames,mouse,progress -o - | ffmpeg -y -r 60 -f image2pipe -vcodec ppm -i - -vcodec libx264 -preset ultrafast -pix_fmt yuv420p -crf 1 -threads 0 -bf 0 gource.mp4</code></li>
<li>Create Gif: <code>ffmpeg -i gource.mp4 -r 10 -vf "scale=800:-1,split[s0][s1];[s0]palettegen[p];[s1][p]paletteuse" tesseract_evolution.gif</code></li>
</ul>
<h1><a class="anchor" id="autotoc_md12"></a>
TODO's</h1>
<p >Warning: These packages are under heavy development and are subject to change.</p>
<p >See <a href="https://github.com/tesseract-robotics/tesseract/issues/66">issue #66</a></p>
<h1><a class="anchor" id="autotoc_md13"></a>
Build Instructions</h1>
<p >1) Clone repository into your workspace 2) Clone the repositories in the dependencies.rosinstall file using wstool or some other method (e.g. manually git cloning them) 3) Build the workspace using catkin tools, colcon, or a similar tool</p>
<p >NOTE: To speed up clean build you may want to add tesseract_ext to an extended workspace.</p>
<p >NOTE: Melodic install TaskFlow from <a href="https://launchpad.net/~ros-industrial/+archive/ubuntu/ppa">ROS-Industrial PPA</a>.</p>
<h2><a class="anchor" id="autotoc_md14"></a>
Building with Clang-Tidy Enabled</h2>
<p >Must pass the -DTESSERACT_ENABLE_CLANG_TIDY=ON to cmake when building. This is automatically enabled if cmake argument -DTESSERACT_ENABLE_TESTING_ALL=ON is passed.</p>
<h2><a class="anchor" id="autotoc_md15"></a>
Building Tests</h2>
<p >Must pass the -DTESSERACT_ENABLE_TESTING=ON to cmake when wanting to build tests. This is automatically enabled if cmake argument -DTESSERACT_ENABLE_TESTING_ALL=ON is passed.</p>
<p >NOTE: If you are building using catkin tools, use <code>catkin build --force-cmake -DTESSERACT_ENABLE_TESTING=ON</code>.</p>
<h3><a class="anchor" id="autotoc_md16"></a>
Running Tests</h3>
<p >Tesseract packages use ctest because it is ROS agnostic, so to run the test call <code>catkin test --no-deps tesseract_motion_planners tesseract_process_managers tesseract_time_parameterization</code></p>
<h2><a class="anchor" id="autotoc_md17"></a>
Building Code Coverage</h2>
<p >Must pass the -DTESSERACT_ENABLE_CODE_COVERAGE=ON to cmake when wanting to build code coverage. The code coverage report is located in each individuals build directory inside a ccov/all-merged folder. Open the index.html file to see the packages code coverage report.</p>
<p >NOTE: Must be a clean build when generating a code coverage report. Also must build in debug.</p>
<h3><a class="anchor" id="autotoc_md18"></a>
Exclude Code From Code Coverage</h3>
<ul>
<li>LCOV_EXCL_LINE<ul>
<li>Lines containing this marker will be excluded.</li>
</ul>
</li>
<li>LCOV_EXCL_START<ul>
<li>Marks the beginning of an excluded section. The current line is part of this section.</li>
</ul>
</li>
<li>LCOV_EXCL_STOP<ul>
<li>Marks the end of an excluded section. The current line not part of this section.</li>
</ul>
</li>
</ul>
<p >.. NOTE: You can replace <b>LCOV</b> above with <b>GCOV</b> or <b>GCOVR</b>.</p>
<h1><a class="anchor" id="autotoc_md19"></a>
Quality Tools Leverage</h1>
<p >Tesseract currently leverages Compiler Warnigs, Clang Tidy and Code Coverage. All warnings produced by Compiler and Clang Tidy are treated as errors during CI builds.</p>
<ul>
<li>Compiler<ul>
<li>Wall</li>
<li>Wextra</li>
<li>Wconversion</li>
<li>Wsign-conversion</li>
<li>Wno-sign-compare</li>
<li>Wnon-virtual-dtor</li>
</ul>
</li>
<li>Clang Tidy<ul>
<li>clang-analyzer-*</li>
<li>bugprone-*</li>
<li>cppcoreguidelines-avoid-goto</li>
<li>cppcoreguidelines-c-copy-assignment-signature</li>
<li>cppcoreguidelines-interfaces-global-init</li>
<li>cppcoreguidelines-narrowing-conversions</li>
<li>cppcoreguidelines-no-malloc</li>
<li>cppcoreguidelines-slicing</li>
<li>cppcoreguidelines-special-member-functions</li>
<li>misc-*,-misc-non-private-member-variables-in-classes</li>
<li>modernize-*,-modernize-use-trailing-return-type,-modernize-use-nodiscard</li>
<li>performance-*</li>
<li>readability-avoid-const-params-in-decls</li>
<li>readability-container-size-empty</li>
<li>readability-delete-null-pointer</li>
<li>readability-deleted-default</li>
<li>readability-else-after-return</li>
<li>readability-function-size</li>
<li>readability-identifier-naming</li>
<li>readability-inconsistent-declaration-parameter-name</li>
<li>readability-misleading-indentation</li>
<li>readability-misplaced-array-index</li>
<li>readability-non-const-parameter</li>
<li>readability-redundant-*</li>
<li>readability-simplify-*</li>
<li>readability-static-*</li>
<li>readability-string-compare</li>
<li>readability-uniqueptr-delete-release</li>
<li>readability-rary-objects</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md20"></a>
Build Branch Sphinx Documentation</h1>
<div class="fragment"><div class="line">cd gh_pages</div>
<div class="line">sphinx-build . output</div>
</div><!-- fragment --><p> Now open gh_pages/output/index.rst and remove <em>output</em> directory before commiting changes.</p>
<h1><a class="anchor" id="autotoc_md21"></a>
Debugging Windows Build</h1>
<ul>
<li>Search Directories CI<ul>
<li>dir /s /b c:\opt\ros\noetic*assimp*</li>
</ul>
</li>
<li>Location of ROS Windows Builds<ul>
<li><a href="https://ros-win.visualstudio.com/ros-win/_build">https://ros-win.visualstudio.com/ros-win/_build</a></li>
<li><a href="https://ros-win.visualstudio.com/ros-win/_build/results?buildId=8711&view=artifacts&type=publishedArtifacts">https://ros-win.visualstudio.com/ros-win/_build/results?buildId=8711&amp;view=artifacts&amp;type=publishedArtifacts</a> </li>
</ul>
</li>
</ul>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Mar 22 2023 16:00:02 for Tesseract Planning by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
